# -*- coding: utf-8 -*-

from chemcaption.featurize.misc import SVGFeaturizer
from chemcaption.molecules import SMILESMolecule


def test_svg_featurizer():
    featurizer = SVGFeaturizer()

    molecule = SMILESMolecule("O")
    output = "<?xml version='1.0' encoding='iso-8859-1'?>\n<svg version='1.1' baseProfile='full'\n              xmlns='http://www.w3.org/2000/svg'\n                      xmlns:rdkit='http://www.rdkit.org/xml'\n                      xmlns:xlink='http://www.w3.org/1999/xlink'\n                  xml:space='preserve'\nwidth='300px' height='300px' viewBox='0 0 300 300'>\n<!-- END OF HEADER -->\n<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='300.0' height='300.0' x='0.0' y='0.0'> </rect>\n<path class='atom-0' d='M 114.9 128.9\nL 118.7 128.9\nL 118.7 141.0\nL 133.2 141.0\nL 133.2 128.9\nL 137.1 128.9\nL 137.1 157.2\nL 133.2 157.2\nL 133.2 144.2\nL 118.7 144.2\nL 118.7 157.2\nL 114.9 157.2\nL 114.9 128.9\n' fill='#FF0000'/>\n<path class='atom-0' d='M 142.7 156.2\nQ 143.4 154.5, 145.1 153.5\nQ 146.7 152.5, 149.0 152.5\nQ 151.8 152.5, 153.4 154.0\nQ 155.0 155.6, 155.0 158.3\nQ 155.0 161.1, 152.9 163.6\nQ 150.9 166.2, 146.7 169.3\nL 155.3 169.3\nL 155.3 171.4\nL 142.7 171.4\nL 142.7 169.6\nQ 146.2 167.1, 148.2 165.3\nQ 150.3 163.5, 151.3 161.8\nQ 152.3 160.1, 152.3 158.4\nQ 152.3 156.6, 151.4 155.6\nQ 150.5 154.6, 149.0 154.6\nQ 147.5 154.6, 146.5 155.2\nQ 145.5 155.8, 144.8 157.2\nL 142.7 156.2\n' fill='#FF0000'/>\n<path class='atom-0' d='M 159.1 143.0\nQ 159.1 136.2, 162.5 132.4\nQ 165.8 128.6, 172.1 128.6\nQ 178.4 128.6, 181.7 132.4\nQ 185.1 136.2, 185.1 143.0\nQ 185.1 149.9, 181.7 153.8\nQ 178.3 157.7, 172.1 157.7\nQ 165.9 157.7, 162.5 153.8\nQ 159.1 149.9, 159.1 143.0\nM 172.1 154.5\nQ 176.4 154.5, 178.7 151.6\nQ 181.1 148.7, 181.1 143.0\nQ 181.1 137.4, 178.7 134.6\nQ 176.4 131.8, 172.1 131.8\nQ 167.8 131.8, 165.4 134.6\nQ 163.1 137.4, 163.1 143.0\nQ 163.1 148.7, 165.4 151.6\nQ 167.8 154.5, 172.1 154.5\n' fill='#FF0000'/>\n</svg>\n"

    results = featurizer.featurize(molecule)
    assert results.item() == output

    molecule = SMILESMolecule("CCCCCCCCCCCCCCCC")
    output = "<?xml version='1.0' encoding='iso-8859-1'?>\n<svg version='1.1' baseProfile='full'\n              xmlns='http://www.w3.org/2000/svg'\n                      xmlns:rdkit='http://www.rdkit.org/xml'\n                      xmlns:xlink='http://www.w3.org/1999/xlink'\n                  xml:space='preserve'\nwidth='300px' height='300px' viewBox='0 0 300 300'>\n<!-- END OF HEADER -->\n<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='300.0' height='300.0' x='0.0' y='0.0'> </rect>\n<path class='bond-0 atom-0 atom-1' d='M 13.6,154.3 L 31.9,143.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-1 atom-1 atom-2' d='M 31.9,143.9 L 50.0,154.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-2 atom-2 atom-3' d='M 50.0,154.6 L 68.2,144.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-3 atom-3 atom-4' d='M 68.2,144.2 L 86.3,154.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-4 atom-4 atom-5' d='M 86.3,154.8 L 104.6,144.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-5 atom-5 atom-6' d='M 104.6,144.4 L 122.7,155.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-6 atom-6 atom-7' d='M 122.7,155.1 L 140.9,144.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-7 atom-7 atom-8' d='M 140.9,144.7 L 159.1,155.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-8 atom-8 atom-9' d='M 159.1,155.3 L 177.3,144.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-9 atom-9 atom-10' d='M 177.3,144.9 L 195.4,155.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-10 atom-10 atom-11' d='M 195.4,155.6 L 213.7,145.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-11 atom-11 atom-12' d='M 213.7,145.2 L 231.8,155.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-12 atom-12 atom-13' d='M 231.8,155.8 L 250.0,145.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-13 atom-13 atom-14' d='M 250.0,145.4 L 268.1,156.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path class='bond-14 atom-14 atom-15' d='M 268.1,156.1 L 286.4,145.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />\n<path d='M 31.0,144.5 L 31.9,143.9 L 32.8,144.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 49.1,154.0 L 50.0,154.6 L 50.9,154.0' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 67.3,144.7 L 68.2,144.2 L 69.1,144.7' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 85.4,154.3 L 86.3,154.8 L 87.3,154.3' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 103.7,145.0 L 104.6,144.4 L 105.5,145.0' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 121.8,154.5 L 122.7,155.1 L 123.6,154.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 140.0,145.2 L 140.9,144.7 L 141.9,145.2' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 158.1,154.8 L 159.1,155.3 L 160.0,154.8' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 176.4,145.5 L 177.3,144.9 L 178.2,145.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 194.5,155.0 L 195.4,155.6 L 196.3,155.0' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 212.7,145.7 L 213.7,145.2 L 214.6,145.7' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 230.9,155.3 L 231.8,155.8 L 232.7,155.3' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 249.1,146.0 L 250.0,145.4 L 250.9,146.0' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n<path d='M 267.2,155.5 L 268.1,156.1 L 269.0,155.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;' />\n</svg>\n"

    results = featurizer.featurize(molecule)
    assert results.item() == output
